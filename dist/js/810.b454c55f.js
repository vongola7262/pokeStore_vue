"use strict";(self["webpackChunkjs_shop"]=self["webpackChunkjs_shop"]||[]).push([[810],{4810:function(e,t,o){o.r(t),o.d(t,{default:function(){return q}});var s=o(3099),a=o(5860),l=o(8317);const n={class:"text-end mt-4"},d={class:"table mt-4"},i=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"名稱"),(0,s._)("th",null,"折扣百分比"),(0,s._)("th",null,"到期日"),(0,s._)("th",null,"是否啟用"),(0,s._)("th",null,"編輯")])],-1),u={key:0,class:"text-success"},p={key:1,class:"text-muted"},c={class:"btn-group"},r=["onClick"],m=["onClick"];function h(e,t,o,h,_,b){const g=(0,s.up)("LoadingImg"),v=(0,s.up)("PageList"),y=(0,s.up)("Modal");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(g,{loadStatus:_.isLoading},null,8,["loadStatus"]),(0,s._)("div",null,[(0,s._)("div",n,[(0,s._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(0,a.iM)((e=>b.openMenu(!1)),["prevent"]))}," 建立新的優惠券 ")]),(0,s._)("table",d,[i,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(_.vocList,((t,o)=>((0,s.wg)(),(0,s.iD)("tr",{key:o},[(0,s._)("td",null,(0,l.zw)(t.title),1),(0,s._)("td",null,(0,l.zw)(t.percent)+"%",1),(0,s._)("td",null,(0,l.zw)(e.$filterdate.date(t.due_date)),1),(0,s._)("td",null,[1===t.is_enabled?((0,s.wg)(),(0,s.iD)("span",u,"啟用")):((0,s.wg)(),(0,s.iD)("span",p,"未起用"))]),(0,s._)("td",null,[(0,s._)("div",c,[(0,s._)("button",{class:"btn btn-outline-primary btn-sm",onClick:(0,a.iM)((e=>b.openMenu(!0,t)),["prevent"])},"編輯",8,r),(0,s._)("button",{class:"btn btn-outline-danger btn-sm",onClick:(0,a.iM)((e=>b.deleteItem(t)),["prevent"])},"刪除",8,m)])])])))),128))])]),(0,s.Wm)(v,{pages:_.pages,onNextpage:b.getOrder},null,8,["pages","onNextpage"]),(0,s.Wm)(y,{ref:"vcModal",voucher:_.tempProducts,onUpdateCoupon:b.sendItem},null,8,["voucher","onUpdateCoupon"])])],64)}const _={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},b={class:"modal-dialog",role:"document"},g={class:"modal-content"},v=(0,s._)("div",{class:"modal-header"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},"新增優惠券"),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),y={class:"modal-body"},f={class:"mb-3"},w=(0,s._)("label",{for:"title"},"標題",-1),C={class:"mb-3"},M=(0,s._)("label",{for:"coupon_code"},"優惠碼",-1),x={class:"mb-3"},k=(0,s._)("label",{for:"due_date"},"到期日",-1),L={class:"mb-3"},j=(0,s._)("label",{for:"price"},"折扣百分比",-1),D={class:"mb-3"},$={class:"form-check"},I=(0,s._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),O={class:"modal-footer"},P=(0,s._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function U(e,t,o,l,n,d){return(0,s.wg)(),(0,s.iD)("div",_,[(0,s._)("div",b,[(0,s._)("div",g,[v,(0,s._)("div",y,[(0,s._)("div",f,[w,(0,s.wy)((0,s._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>n.tempCoupon.title=e),placeholder:"請輸入標題"},null,512),[[a.nr,n.tempCoupon.title]])]),(0,s._)("div",C,[M,(0,s.wy)((0,s._)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>n.tempCoupon.code=e),placeholder:"請輸入優惠碼"},null,512),[[a.nr,n.tempCoupon.code]])]),(0,s._)("div",x,[k,(0,s.wy)((0,s._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>n.due_date=e)},null,512),[[a.nr,n.due_date]])]),(0,s._)("div",L,[j,(0,s.wy)((0,s._)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[3]||(t[3]=e=>n.tempCoupon.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[a.nr,n.tempCoupon.percent,void 0,{number:!0}]])]),(0,s._)("div",D,[(0,s._)("div",$,[(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>n.tempCoupon.is_enabled=e),id:"is_enabled"},null,512),[[a.e8,n.tempCoupon.is_enabled]]),I])])]),(0,s._)("div",O,[P,(0,s._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",n.tempCoupon))}," 更新優惠券 ")])])])],512)}var N=o(7788),V=o.n(N),S={name:"myModal",props:{voucher:{type:Object,default(){return{}}}},emits:["update-coupon"],data(){return{myModal:{},tempCoupon:{},due_date:""}},watch:{voucher(e){if(this.tempCoupon=e,e.due_date){const t=new Date(1e3*e.due_date).toISOString().split("T");this.due_date=t[0]}else this.due_date=""},due_date(e){this.tempCoupon.due_date=Math.floor(new Date(e)/1e3)}},methods:{showModal(){this.myModal.show()},hiddenModal(){this.myModal.hide()}},mounted(){this.myModal=new(V())(this.$refs.modal)}},Z=o(5727);const z=(0,Z.Z)(S,[["render",U]]);var W=z,H=o(9409),Y=o(7364),K={components:{Modal:W,PageList:H.Z,LoadingImg:Y.Z},data(){return{vocList:[],pages:{},tempProducts:{},isNew:!1,isLoading:!1}},inject:["emitter"],methods:{getOrder(e=1){const t=`https://vue3-course-api.hexschool.io/api/jysing-aip/admin/coupons/?page=${e}`;this.isLoading=!0,this.axios.get(t).then((e=>{this.isLoading=!1,this.vocList=e.data.coupons,this.pages=e.data.pagination}))},openMenu(e,t){this.tempProducts=e?{...t}:{},this.isNew=e,this.$refs.vcModal.showModal()},sendItem(e){this.tempProducts=e,console.log(e);let t="https://vue3-course-api.hexschool.io/api/jysing-aip/admin/coupon",o="post";this.isNew&&(t=`https://vue3-course-api.hexschool.io/api/jysing-aip/admin/coupon/${e.id}`,o="put"),this.isLoading=!0,this.axios({method:o,url:t,data:{data:this.tempProducts}}).then((e=>{this.isLoading=!1,this.$refs.vcModal.hiddenModal(),e.data.success?(this.getOrder(),this.emitter.emit("push-message",{style:"success",title:"更新成功",content:"優惠券已更新"})):this.emitter.emit("push-message",{style:"danger",title:"更新失敗",content:e.data.message.join(",")})}))},deleteItem(e){const t=`https://vue3-course-api.hexschool.io/api/jysing-aip/admin/coupon/${e.id}`;this.isLoading=!0,this.axios.delete(t,e.id).then((e=>{this.isLoading=!1,this.getOrder()}))}},created(){this.getOrder()}};const T=(0,Z.Z)(K,[["render",h]]);var q=T}}]);
//# sourceMappingURL=810.b454c55f.js.map